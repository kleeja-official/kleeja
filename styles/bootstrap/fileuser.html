


<div class="mt-3 mb-3">

    <IF NAME="user_himself">
        <h2>{lang.YOUR_FILEUSER}</h2>
    <ELSE>
        <h2>{title}</h2>
    </IF>

    <IF NAME="user_name">
        <p class="text-muted">
            {lang.PUBLIC_USER_FILES}: {user_name} ({lang.ALL_FILES}: {nums_rows} & {lang.ALL_FOLDERS}: {all_folders_count})
        </p>
    </IF>
</div>




<IF NAME="user_himself">
    <form name="c" action="{action}" method="post" onsubmit="javascript:return confirm_from();">
        
        <div class="form-row mb-2">
            <div class="col col-md-auto">
            	<input type="text" name="create_new_folder" placeholder="{lang.NEW_FOLDER_NAME}" class="form-control">
            </div>
            <div class="col col-md-auto">
                <input value="{lang.CREATE_FOLDER}" name="create_folder_submit" type="submit" style="height:auto;" class="btn btn-primary btn-block">
            </div>
        </div>
</IF>


<IF NAME="no_results">
    <!-- no files yet -->
    <div id="alert alert-info">
        {lang.NO_FILE_USER}
    </div>
<ELSE>


<div class="card-columns">
    
    <LOOP NAME="darr">
        <div class="card file-user-image mb-2" data-toggle="tooltip"  data-html="true">
                <a href="{{url_folder}}">
                    <img class="card-img-top img-fluid mw-100" src="{STYLE_PATH}images/ucp_folder.png" alt="{{name}}"  onError="this.onerror=null;this.src='images/not_exists.jpg';">
                </a>
                <IF NAME="user_himself">
                    <div class="kcheck-image">
                        <input id="del_d_{{id}}" name="del_d_{{id}}" type="checkbox" value="{{id}}" rel="_del"  />
                    </div>
                </IF>
                <div class="folder-name">
                    <a>{{name}}</a>
                </div>
            </div>
    </LOOP>
    <LOOP NAME="arr">


        <IF LOOP="is_image">

            <!-- image -->
            <div class="card file-user-image mb-2" data-toggle="tooltip"  data-html="true" title="{lang.FILEUPS}:{{uploads}} <br> {lang.FILESIZE}:{{size}} <br> {lang.FILEDATE}:{{time}}" id="su[{{id}}]">
                <a href="{{href}}" target="_blank">
                    <img class="card-img-top img-fluid mw-100" src="{{thumb_link}}" alt="{{name_file}}"  onError="this.onerror=null;this.src='images/not_exists.jpg';">
                </a>
                <IF NAME="user_himself">
                    <div class="kcheck-image">
                        <input id="del_{{id}}" name="del_{{id}}" type="checkbox" value="{{id}}" rel="_del"  />
                    </div>
                </IF>
            </div>

        <ELSE>

            <!-- file -->
            <div class="card card-info card-inverse mb-2 file-user-file" style="height: 200px">
                <div class="card-body">
                    <a href="{{href}}" target="_blank"><h5 class="card-title"><img src="{{thumb_link}}" alt="{{name_file}}" height="30" width="30"> {{name_file}}</h5></a>
                    <p class="card-text mt-2">
                        <span>{lang.FILEUPS}: {{uploads}}</span><br>
                        <span>{lang.FILESIZE}: {{size}}</span><br>
                        <span>{lang.FILEDATE}: {{time}}</span>
                        <IF NAME="user_himself">
                        <div class="kcheck">
                            <input id="del_{{id}}" name="del_{{id}}" type="checkbox" value="{{id}}" rel="_del" />
                        </div>
                        </IF>
                    </p>
                </div>
            </div>

        </IF>
    </LOOP>
</div>

</IF>


<!-- pagination -->
{page_nums}
<div class="clearfix"></div>

<IF NAME="user_himself">

    <div class="row justify-content-between mb-5">
        <div class="col col-md-auto"><input type="submit" name="submit_files"  class="btn btn-outline-danger" value="{lang.DEL_SELECTED}" /></div>
        <div class="col col-md-auto"><input type="submit" name="submit_all_files"  class="btn btn-outline-danger" value="{lang.DEL_ALL}" /></div>
        <div class="form-row col-md-auto">
            <div class="col col-md-auto" style="width: 200px;">
            	<select name="to_folder" id="to_folder" class="form-control">
                    <option disabled selected>--</option>
                    {folders_tree}
                </select>

            </div>
            <div class="col col-md-auto">
                <input name="to_folder_move" value="{lang.MOVE_FILES}" type="submit" class="btn btn-outline-primary">
            </div>
        </div>
        <div class="col col-md-auto">[ <a href="javascript:void(0);" onclick="checkAll(document.c, '_del', 'su');" title="{lang.CHECK_ALL}">{lang.CHECK_ALL}</a> ]</div>
    </div>

    {H_FORM_KEYS}

    </form>

    <!-- link user folder -->
    <div class="card">
        <div class="card-header copylink">{lang.COPY_AND_GET_DUD}</div>
        <div class="card-body">
            <input class="form-control" readonly="readonly" onclick="this.select();" type="text" name="option" value="{your_fileuser}" />
        </div>
    </div>

</IF>



<IF NAME="user_himself">
    <script type="text/javascript">
        function confirm_from()
        {
            if(confirm('{lang.ARE_YOU_SURE_DO_THIS}')) {
                return true;
            }else {
                return false;
            }
        }

        function checkAll(form, id, _do_c_, c, c2) {
            for (var i = 0; i < form.elements.length; i++) {
                if (form.elements[i].getAttribute("rel") != id) continue;
                if (form.elements[i].checked) {
                    uncheckAll(form, id, _do_c_, c, c2);
                    break
                }
                form.elements[i].checked = true;
            }
        }

        function uncheckAll(form, id, _do_c_, c, c2) {
            for (var i = 0; i < form.elements.length; i++) {
                if (form.elements[i].getAttribute("rel") != id) continue;
                form.elements[i].checked = false;
            }
        }
        
        let select = document.getElementById("to_folder");
        let options = select.options;
        let changed = false;
        
        select.addEventListener("mousedown", function() {
          changed = false;
        });
        
        select.addEventListener("mouseup", function() {
          if (!changed) {
            for (let i = 0; i < options.length; i++) {
              if (options[i].hasAttribute("data-default")) {
                options[i].textContent = options[i].getAttribute("data-default");
              }
            }
          }
        });
        
        select.addEventListener("change", function() {
          let selectedOption = select.options[select.selectedIndex];
          if (selectedOption.hasAttribute("data-text")) {
            selectedOption.textContent = selectedOption.getAttribute("data-text");
          } else if (selectedOption.hasAttribute("data-default")) {
            selectedOption.textContent = selectedOption.getAttribute("data-default");
          }
          changed = true;
        });

    </script>
</IF>
